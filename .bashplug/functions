#.bashplug/functions
# vim: filetype=sh

function tar_compress()
{
  local target="$1"

  if [ -e "$1" ] # $1 has to be w/o '/'
  then
    prnt_info "tar -zcf ""$1.tar.gz"" ""$1"
    tar -zcf "$1.tar.gz" "$1"
  else
    prnt_err "file ""$1"" does not exist"
  fi
}

function ps_list_by()
{
  local property="$1"
  local value1="$2"

  ps -ef | grep $property | grep $value1

}

function dump_disk()
{
  # parse cmdline -> options are optional
  
  local source=$1

  local target=$2

  local options="$3"

  # archbase /mnt/stuff/raw # dd if=/dev/sda3 of=sda3.img bs=200M status=progress 
  # 200M: 25MB/s
  # 10M:  50MB/s
  # 1M:   55MB/s
  # 256K: 60MB/s
  # after while, sev gbs all ~50
  # one after another, so could be cached

  # save start time

  # launch dd

  # get process id

  # if process is running
  #    monitor time (every sec)
  #    end exit after is gone
  # this just monitors exec time in terminal
  while [[ `ps -p 3500 | grep 3500` != "" ]]
  do 
    retval=`ps -o etime= 3500`
    echo -ne "$retval\r"
    sleep 1
  done

  # save end time

  # print SECONDS



}

function mount_image_as_device()
{
  # custom@custom:/media/My Passport/mom$ sudo mount -t ntfs-3g -o loop mom03*.img /mnt

  echo mounting $1 as drive in $2 # by default ntfs-3g

  # but actually shall recognize drive

  # mount -t ntfs-3g -o loop sda3-w10.img /mnt/windows/
  # umount /mnt/windows/


}


